#!/opt/local/bin/expect

# $Id$

spawn ssh "admin@$argv"
expect "Password:"
send "Sourcefire\r"
expect "> " { send "expert\r" }
expect "admin@"
send "sudo -i\r"
expect "Password:" { send "Sourcefire\r" }
expect "root@"
send "ed /etc/ssh/sshd_config\r"
expect "2*"
send "/PermitRootLogin\r"
expect PermitRootLogin
send "c\rPermitRootLogin without-password\r.\rwq\r"
expect "root@"
send "ed /usr/local/sf/htdocs/templates/html_templates/pam/sshd_config.tt\r"
expect "2*"
send "/PermitRootLogin\r"
expect PermitRootLogin
send "c\rPermitRootLogin without-password\r.\rwq\r"
expect "root@"
send "/etc/rc.d/init.d/sshd restart\r"
expect "root@"
send "exit\r"
expect "admin@" { send "exit\r" }
expect "> " { send "exit\r" }
puts "\n"


